# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins)) +
geom_tile(color = "white") +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = unique(avg_tree_visits$tree_id), color = "lightgrey", linetype = "dashed") +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree.png'), plot = gg, width = 8, height = 16, dpi = 300)
unique(avg_tree_visits$tree_id)
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins)) +
geom_tile(color = "white") +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = unique(avg_tree_visits$tree_id), color = "black", linetype = "dashed") +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins)) +
geom_tile(color = "white") +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_vline(yintercept = unique(avg_tree_visits$tree_id), color = "black", linetype = "dashed") +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins)) +
geom_tile(color = "white") +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = unique(avg_tree_visits$tree_id), color = "black", linetype = "dashed") +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins)) +
geom_tile(color = "white") +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq_along(unique(avg_tree_visits$tree_id)), color = "black", linetype = "dashed") +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins)) +
geom_tile(color = "white") +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq_along(unique(avg_tree_visits$tree_id)), color = "grey", linetype = "dashed") +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree.png'), plot = gg, width = 8, height = 16, dpi = 300)
n_trees <- length(unique(avg_tree_visits$tree_id))
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins)) +
geom_tile(color = "white") +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "dashed") +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree.png'), plot = gg, width = 8, height = 16, dpi = 300)
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins)) +
geom_tile(color = "white") +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree.png'), plot = gg, width = 8, height = 16, dpi = 300)
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree.png'), plot = gg, width = 8, height = 14, dpi = 300)
visits <- visits_dt[, .(
entry_time = min(entry_time),
exit_time  = max(exit_time),
n_points   = sum(n_points)
), by = .(individual.local.identifier, tree_id, merge_group)]
visits[, merge_group := NULL]
#duration for each visit in minutes
visits <- visits %>%
mutate(duration_mins = as.numeric(difftime(exit_time, entry_time, units = "mins")))
visits$duration_mins[visits$duration_mins == 0] <- 2.5
visits$date <- as.Date(visits$entry_time)
visits <- visits[format(visits$entry_time, "%H:%M:%S") < "18:00:00", ]
visits <- visits[format(visits$exit_time, "%H:%M:%S") < "18:00:00", ]
avg_tree_visits <- visits %>%
group_by(tree_id, date) %>%
summarise(
avg_duration_mins = mean(duration_mins, na.rm = TRUE),
median_duration_mins = median(duration_mins, na.rm = TRUE),
max_duration_mins = max(duration_mins, na.rm = TRUE),
n_visits = n(),
.groups = "drop"
)
n_trees <- length(unique(avg_tree_visits$tree_id))
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins)) +
geom_tile(color = "white") +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
avg_tree_visits$avg_duration_mins[avg_tree_visits$avg_duration_mins < 2.5] <- NA
View(avg_tree_visits)
avg_tree_visits$avg_duration_mins[avg_tree_visits$avg_duration_mins <= 2.5] <- NA
n_trees <- length(unique(avg_tree_visits$tree_id))
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins)) +
geom_tile(color = "white") +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
?geom_time
??geom_tile
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins)) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins, na.rm = T)) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins) na.rm = T) +
avg_tree_visits <- avg_tree_visits[!avg_tree_visits$avg_duration_mins <= 2.5,]
View(avg_tree_visits)
avg_tree_visits <- avg_tree_visits[-avg_tree_visits$avg_duration_mins <= 2.5,]
View(avg_tree_visits)
avg_tree_visits <- visits %>%
group_by(tree_id, date) %>%
summarise(
avg_duration_mins = mean(duration_mins, na.rm = TRUE),
median_duration_mins = median(duration_mins, na.rm = TRUE),
max_duration_mins = max(duration_mins, na.rm = TRUE),
n_visits = n(),
.groups = "drop"
)
avg_tree_visits_filtered <- avg_tree_visits[avg_tree_visits$avg_duration_mins > 2.5, ]
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits_filtered, aes(x = date, y = factor(tree_id), fill = avg_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits_filtered, aes(x = date, y = factor(tree_id), fill = max_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits_filtered, aes(x = date, y = factor(tree_id), fill = median_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits_filtered, aes(x = date, y = factor(tree_id), fill = avg_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree.png'), plot = gg, width = 8, height = 14, dpi = 300)
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree.png'), plot = gg, width = 8, height = 12, dpi = 300)
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree.png'), plot = gg, width = 8, height = 10, dpi = 300)
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree.png'), plot = gg, width = 8, height = 9, dpi = 300)
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree.png'), plot = gg, width = 9, height = 9, dpi = 300)
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits_filtered, aes(x = date, y = factor(tree_id), fill = max_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'max_dur_dipx_pertree.png'), plot = gg, width = 9, height = 9, dpi = 300)
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits_filtered, aes(x = date, y = factor(tree_id), fill = median_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'median_dur_dipx_pertree.png'), plot = gg, width = 9, height = 9, dpi = 300)
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits, aes(x = date, y = factor(tree_id), fill = avg_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Avg Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree_all.png'), plot = gg, width = 9, height = 12, dpi = 300)
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree_all.png'), plot = gg, width = 9, height = 13, dpi = 300)
ggsave(filename = paste0(plot_dir, 'avg_dur_dipx_pertree_all.png'), plot = gg, width = 9, height = 14, dpi = 300)
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits_filtered, aes(x = date, y = factor(tree_id), fill = median_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Median Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'median_dur_dipx_pertree.png'), plot = gg, width = 9, height = 9, dpi = 300)
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits_filtered, aes(x = date, y = factor(tree_id), fill = max_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Max Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'median_dur_dipx_pertree.png'), plot = gg, width = 9, height = 9, dpi = 300)
ggsave(filename = paste0(plot_dir, 'max_dur_dipx_pertree.png'), plot = gg, width = 9, height = 9, dpi = 300)
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits_filtered, aes(x = date, y = factor(tree_id), fill = median_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Median Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Average Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'median_dur_dipx_pertree.png'), plot = gg, width = 9, height = 9, dpi = 300)
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits_filtered, aes(x = date, y = factor(tree_id), fill = median_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Median Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Median Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'median_dur_dipx_pertree.png'), plot = gg, width = 9, height = 9, dpi = 300)
# Make sure avg_tree_visits exists (from previous step)
gg <- ggplot(avg_tree_visits_filtered, aes(x = date, y = factor(tree_id), fill = max_duration_mins), na.rm = T) +
geom_tile(color = "white",  na.rm = T) +                # Each tile represents tree/day
scale_fill_viridis_c(option = "plasma",    # Nice color scale for duration
name = "Max Duration\n(minutes)") +
labs(x = "Date", y = "Tree ID", title = "Max Coati Visit Duration per Tree per Day") +
geom_hline(yintercept = seq(0.5, n_trees + 0.5, by = 1),
color = "lightgrey", linetype = "11",  # shorter dashes and gaps
size = 0.3) +
theme_classic(base_size = 10) +
theme(axis.text.x = element_text(angle = 0, hjust = 1))
gg
ggsave(filename = paste0(plot_dir, 'max_dur_dipx_pertree.png'), plot = gg, width = 9, height = 9, dpi = 300)
visits_perday <- visits %>%
group_by(date) %>%
summarise(
avg_duration_mins = mean(duration_mins, na.rm = TRUE),
n_visits = n(),
.groups = "drop"
)
View(visits_perday)
visits_perday <- visits %>%
group_by(date) %>%
summarise(
avg_duration_mins = mean(duration_mins, na.rm = TRUE),
max_duration_mins = max(duration_mins, na.rm = TRUE),
n_visits = n(),
.groups = "drop"
)
plot(visits_perday$date, visits_perday$avg_duration_mins)
ggplot(visits_perday, aes(date, avg_duration_mins))+
geom_point()
ggplot(visits_perday, aes(date, avg_duration_mins))+
geom_point()+
theme_minimal()
ggplot(visits_perday, aes(date, avg_duration_mins))+
geom_point()+
ylab("Mean Visit Duration")+
theme_minimal()
ggplot(visits_perday, aes(date, avg_duration_mins))+
geom_point()+
ylab("Mean Dipteryx Visit Duration (minutes)")+
theme_minimal()
ggplot(visits_perday, aes(date, avg_duration_mins))+
geom_point()+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(method = "lm", se = FALSE)+
theme_minimal()
ggplot(visits_perday, aes(date, avg_duration_mins))+
geom_point()+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(method = "lm", se = T)+
theme_minimal()
ggsave(filename = paste0(plot_dir, 'visit_dur_time.png'), plot = g1, width = 7, height = 7, dpi = 300)
g1 <- ggplot(visits_perday, aes(date, avg_duration_mins))+
geom_point()+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(method = "lm", se = T)+
theme_classic()
ggsave(filename = paste0(plot_dir, 'visit_dur_time.png'), plot = g1, width = 7, height = 7, dpi = 300)
g1 <- ggplot()+
geom_point(visits_perday, aes(date, avg_duration_mins))+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(method = "lm", se = T)+
theme_classic()
g1 <- ggplot(visits_perday)+
geom_point(aes(date, avg_duration_mins))+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(method = "lm", se = T)+
theme_classic()
g1
g1 <- ggplot(visits_perday, aes(date, avg_duration_mins))+
geom_point()+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(method = "lm", se = T)+
theme_classic()
g1
g2 <- ggplot(visits_perday, aes(date, n_visits))+
geom_point()+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(method = "lm", se = T)+
theme_classic()
g2
g2 <- ggplot(visits_perday, aes(date, n_visits))+
geom_point()+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(se = FALSE, method = "gam", formula = y ~ s(log(x)))
g2 <- ggplot(visits_perday, aes(date, n_visits))+
geom_point()+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(se = FALSE, method = "gam", formula = y ~ s(log(x)))+
theme_classic()
g2
g2 <- ggplot(visits_perday, aes(date, n_visits))+
geom_point()+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(se = T, method = "gam", formula = y ~ s(log(x)))+
theme_classic()
g2
?mgcv::gam
g2
g2 <- ggplot(visits_perday, aes(date, n_visits))+
geom_point()+
ylab("Frequency of Dipteryx tree visits")+
geom_smooth(se = T, method = "gam", formula = y ~ s(log(x)))+
theme_classic()
g2
g2 <- ggplot(visits_perday, aes(date, n_visits))+
geom_point()+
ylab("Number of Dipteryx tree visits per day")+
geom_smooth(se = T, method = "gam", formula = y ~ s(log(x)))+
theme_classic()
g2
g2 <- ggplot(visits_perday, aes(date, n_visits))+
geom_point()+
main("Number of Dipteryx tree visits per day")+
ylab("Count")+
geom_smooth(se = T, method = "gam", formula = y ~ s(log(x)))+
theme_classic()
g2 <- ggplot(visits_perday, aes(date, n_visits))+
geom_point()+
title("Number of Dipteryx tree visits per day")+
ylab("Count")+
geom_smooth(se = T, method = "gam", formula = y ~ s(log(x)))+
theme_classic()
g2
g2 <- ggplot(visits_perday, aes(date, n_visits))+
geom_point()+
ggtitle("Number of Dipteryx tree visits per day")+
ylab("Count")+
geom_smooth(se = T, method = "gam", formula = y ~ s(log(x)))+
theme_classic()
g2
visits_perday <- visits %>%
group_by(date, individual.local.identifier) %>%
summarise(
n_visits = n(),
avg_duration_mins_ind = mean(duration_mins, na.rm = TRUE),
.groups = "drop"
) %>%
group_by(date) %>%
summarise(
mean_n_visits = mean(n_visits, na.rm = TRUE), # mean visits per individual
avg_duration_mins = mean(avg_duration_mins_ind, na.rm = TRUE), # mean duration per individual
.groups = "drop"
)
View(visits_perday)
g1 <- ggplot(visits_perday, aes(date, avg_duration_mins))+
geom_point()+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(method = "lm", se = T)+
theme_classic()
g1
#plot showing the mean duration of visits for all inds per day
g1 <- ggplot(visits_perday, aes(date, avg_duration_mins))+
geom_point()+
ylab("Mean Dipteryx Visit Duration (minutes)")+
geom_smooth(method = "lm", se = T)+
theme_classic()
g1
ggsave(filename = paste0(plot_dir, 'visit_dur_time.png'), plot = g1, width = 7, height = 7, dpi = 300)
g2 <- ggplot(visits_perday, aes(date, mean_n_visits))+
geom_point()+
ggtitle("Number of Dipteryx tree visits per day")+
ylab("Count")+
geom_smooth(se = T, method = "gam", formula = y ~ s(log(x)))+
theme_classic()
g2
ggsave(filename = paste0(plot_dir, 'mean_visit_counts.png'), plot = g1, width = 7, height = 7, dpi = 300)
ggsave(filename = paste0(plot_dir, 'mean_visit_counts.png'), plot = g2, width = 7, height = 7, dpi = 300)
